

{\itshape The FOM adapter is the layer standardizing how pressio queries operators from an application.}

It is one of the most important features and a pivotal design in pressio. 



\begin{DoxyParagraph}{Minimally intrusive, you only need to expose information you already have}
Preparing an adapter should only involve {\itshape exposing} some operators in your application. Pressio does NOT require you to provide information that you don\textquotesingle{}t already have. In fact, pressio needs to access {\itshape standard} information/operators that your application already assembles in some form or another. In some cases, these operators might not be fully exposed yet, so all we need is for you to make them accessible. As such, writing an adapter is, in most cases, relatively simple. Note, also, that writing an adapter for {\itshape your} application only involves operating within {\itshape your} application domain, using your data structures and whatever functionalities your application supports. Therefore, this adapter {\itshape lives within your application space}. 
\end{DoxyParagraph}




\begin{DoxyParagraph}{Different adapters for different needs}
Depending on what problem you are trying to solve, we haved designed different adapter concepts/\+APIs, e.\+g. steady, unsteady, exposing only partial information, etc, that fit different scenarios. Note that not all adapters can be used for all ROM methods we support. See below for all the details. 
\end{DoxyParagraph}


~\newline
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md75}{}\doxysection{Steady API}\label{md_pages_components_rom_fom_apis_autotoc_md75}


Intended for when your FOM application is expressed as \[ \boldsymbol{R}(\boldsymbol{y}; \boldsymbol{\mu}) = 0 \] where $y$ is your FOM state, and $R$ is the residual todo finish. \hypertarget{md_pages_components_rom_fom_apis_autotoc_md76}{}\doxysubsubsection{Synopsis}\label{md_pages_components_rom_fom_apis_autotoc_md76}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{class }SteadyFomAdapter}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{keyword}{using} scalar\_type   = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} state\_type    = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} residual\_type = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{comment}{// you need to create an instance of the residual}}
\DoxyCodeLine{  residual\_type createResidual() \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{template}<\textcolor{keyword}{class} OperandType>}
\DoxyCodeLine{  OperandType createApplyJacobianResult(\textcolor{keyword}{const} OperandType \& B) \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// given a state, you compute the residual}}
\DoxyCodeLine{  \textcolor{keywordtype}{void} residual(\textcolor{keyword}{const} state\_type \&,}
\DoxyCodeLine{                residual\_type \&) \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// given a state, compute action of Jacobian on B}}
\DoxyCodeLine{  \textcolor{keyword}{template}<\textcolor{keyword}{class} OperandType>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} applyJacobian(\textcolor{keyword}{const} state\_type \& state,}
\DoxyCodeLine{                     \textcolor{keyword}{const} OperandType \& B,}
\DoxyCodeLine{                     OperandType \& A) \textcolor{keyword}{const};}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md77}{}\doxysubsubsection{Notes}\label{md_pages_components_rom_fom_apis_autotoc_md77}


The steady adapter can ONLY be used for doing steady LSPG ROMs. 

See the following examples\+: add

~\newline
 \DoxyHorRuler{0}
 ~\newline
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md78}{}\doxysection{Continuous-\/time API\+: RHS Only}\label{md_pages_components_rom_fom_apis_autotoc_md78}


Intended for when your FOM application is expressed in {\itshape time-\/continuous} form as \[ \frac{d \boldsymbol{y}}{dt} = \boldsymbol{f}(\boldsymbol{y},t; \boldsymbol{\mu}), \quad \boldsymbol{y}(0;\boldsymbol{\mu}) = \boldsymbol{y}(\boldsymbol{\mu}), \] where $y$ is the full-\/order model (FOM) state, $f$ is what we call the FOM velocity (or RHS), and $t$ is time, and, for some reason, you can/want to only expose the right-\/hand-\/side (or velocity) of your FOM application. todo finish. \hypertarget{md_pages_components_rom_fom_apis_autotoc_md79}{}\doxysubsubsection{Synopsis}\label{md_pages_components_rom_fom_apis_autotoc_md79}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{class }ContTimeFomAdapterVelocityOnly}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{keyword}{using} scalar\_type   = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} state\_type    = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} velocity\_type = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{comment}{// you need to create an instance of the velocity (or RHS)}}
\DoxyCodeLine{  velocity\_type createVelocity() \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// given a state and time, you compute the velocity (or RHS)}}
\DoxyCodeLine{  \textcolor{keywordtype}{void} velocity(\textcolor{keyword}{const} state\_type \&,}
\DoxyCodeLine{                \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                velocity\_type \&) \textcolor{keyword}{const};}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md80}{}\doxysubsubsection{Notes}\label{md_pages_components_rom_fom_apis_autotoc_md80}


This adapter can ONLY be used for doing Galerkin ROMs with explicit time stepping. 

See the following examples\+: add

~\newline
 \DoxyHorRuler{0}
 ~\newline
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md81}{}\doxysection{Continuous-\/time API\+: RHS and Jacobian action}\label{md_pages_components_rom_fom_apis_autotoc_md81}


This API is intended for any system expressible in {\itshape time-\/continuous} form as above, but you expose both the right-\/hand-\/side of your FOM application as well as the action of the velocity\textquotesingle{}s Jacobian on some operand (more on this later). \hypertarget{md_pages_components_rom_fom_apis_autotoc_md82}{}\doxysubsubsection{Synopsis}\label{md_pages_components_rom_fom_apis_autotoc_md82}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{class }ContTimeFomAdapterWithApplyJacobian}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{keyword}{using} scalar\_type   = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} state\_type    = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} velocity\_type = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  velocity\_type createVelocity() \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{void} velocity(\textcolor{keyword}{const} state\_type \&,}
\DoxyCodeLine{                \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                velocity\_type \&) \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// OperandType: typically the data type you use for the decoder's jacobian}}
\DoxyCodeLine{  \textcolor{keyword}{template}<\textcolor{keyword}{class} OperandType>}
\DoxyCodeLine{  OperandType createApplyJacobianResult(\textcolor{keyword}{const} OperandType \&) \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// computes: A = Jac B}}
\DoxyCodeLine{  \textcolor{keyword}{template}<\textcolor{keyword}{class} OperandType>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} applyJacobian(\textcolor{keyword}{const} state\_type \&,}
\DoxyCodeLine{                     \textcolor{keyword}{const} OperandType \& B,}
\DoxyCodeLine{                     \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                     OperandType \& A) \textcolor{keyword}{const};}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md83}{}\doxysubsubsection{Notes}\label{md_pages_components_rom_fom_apis_autotoc_md83}



\begin{DoxyItemize}
\item Can be used for doing Galerkin ROMs with explicit and implicit time stepping
\item Can be used for LSPG and WLS (note that LSPG and WLS only make sense for implicit time integration). 
\end{DoxyItemize}

See the following examples\+: add

~\newline
 \DoxyHorRuler{0}
 ~\newline
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md84}{}\doxysection{Discrete-\/time API}\label{md_pages_components_rom_fom_apis_autotoc_md84}


This API is intended for any system expressible in a discrete-\/time form as \[ \boldsymbol{R}(\boldsymbol{y_{n+1}}, \boldsymbol{y_{n}}, \boldsymbol{y_{n-1}}, ..., t_{n+1}, dt_{n+1}; ...) = \boldsymbol{0} \] where $y$ is the full-\/order model (FOM) state, $t$ is time, and $R$ is the residual. todo finish. \hypertarget{md_pages_components_rom_fom_apis_autotoc_md85}{}\doxysubsubsection{Synopsis}\label{md_pages_components_rom_fom_apis_autotoc_md85}

\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keyword}{class }DiscreteTimeFomAdapter}
\DoxyCodeLine{\{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  \textcolor{keyword}{using} scalar\_type                 = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} state\_type                  = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{  \textcolor{keyword}{using} discrete\_time\_residual\_type = \textcolor{comment}{/* your type */};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{public}:}
\DoxyCodeLine{  discrete\_time\_residual\_type createDiscreteTimeResidual() \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// OperandType: typically the data type you use for the decoder's jacobian}}
\DoxyCodeLine{  \textcolor{keyword}{template}<\textcolor{keyword}{class} OperandType>}
\DoxyCodeLine{  operand\_t createApplyDiscreteTimeJacobianResult(\textcolor{keyword}{const} OperandType \&) \textcolor{keyword}{const};}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{typename} step\_t, \textcolor{keyword}{typename} ... Args>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} discreteTimeResidual(\textcolor{keyword}{const} step\_t \& step,}
\DoxyCodeLine{                            \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                            \textcolor{keyword}{const} scalar\_type \& dt,}
\DoxyCodeLine{                            discrete\_time\_residual\_type \& R,}
\DoxyCodeLine{                            \textcolor{keyword}{const} state\_type \& y\_np1,}
\DoxyCodeLine{                            \textcolor{keyword}{const} state\_type \& y\_n)\textcolor{keyword}{ const}}
\DoxyCodeLine{\textcolor{keyword}{  }\{}
\DoxyCodeLine{    \textcolor{comment}{// given y\_n+1, y\_n}}
\DoxyCodeLine{    \textcolor{comment}{// compute R}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{typename} step\_t, \textcolor{keyword}{typename} ... Args>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} discreteTimeResidual(\textcolor{keyword}{const} step\_t \& step,}
\DoxyCodeLine{                            \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                            \textcolor{keyword}{const} scalar\_type \& dt,}
\DoxyCodeLine{                            discrete\_time\_residual\_type \& R,}
\DoxyCodeLine{                            \textcolor{keyword}{const} state\_type \& y\_np1,}
\DoxyCodeLine{                            \textcolor{keyword}{const} state\_type \& y\_n,}
\DoxyCodeLine{                            \textcolor{keyword}{const} state\_type \& y\_nm1)\textcolor{keyword}{ const}}
\DoxyCodeLine{\textcolor{keyword}{  }\{}
\DoxyCodeLine{    \textcolor{comment}{// given y\_n+1, y\_n, y\_n-\/1}}
\DoxyCodeLine{    \textcolor{comment}{// compute R}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// OperandType: typically the data type you use for the decoder's jacobian}}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{class }step\_t, OperandType, \textcolor{keyword}{class }... Args>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} applyDiscreteTimeJacobian(\textcolor{keyword}{const} step\_t \& step,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} scalar\_type \& dt,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} OperandType \& B,}
\DoxyCodeLine{                                 OperandType \& A,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} state\_type \& y\_np1,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} state\_type \& y\_n)\textcolor{keyword}{ const}}
\DoxyCodeLine{\textcolor{keyword}{  }\{}
\DoxyCodeLine{    \textcolor{comment}{// given y\_n+1, y\_n}}
\DoxyCodeLine{    \textcolor{comment}{// compute A = dR/dy\_n+1 B}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// OperandType: typically the data type you use for the decoder's jacobian}}
\DoxyCodeLine{  \textcolor{keyword}{template} <\textcolor{keyword}{typename} step\_t, \textcolor{keyword}{typename} ... Args>}
\DoxyCodeLine{  \textcolor{keywordtype}{void} applyDiscreteTimeJacobian(\textcolor{keyword}{const} step\_t \& step,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} scalar\_type \& time,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} scalar\_type \& dt,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} OperandType \& B,}
\DoxyCodeLine{                                 OperandType \& A,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} state\_type \& y\_np1,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} state\_type \& y\_n,}
\DoxyCodeLine{                                 \textcolor{keyword}{const} state\_type \& y\_nm1)\textcolor{keyword}{ const}}
\DoxyCodeLine{\textcolor{keyword}{  }\{}
\DoxyCodeLine{    \textcolor{comment}{// given y\_n+1, y\_n, y\_n-\/1}}
\DoxyCodeLine{    \textcolor{comment}{// compute A = dR/dy\_n+1 B}}
\DoxyCodeLine{  \}}
\DoxyCodeLine{\};}

\end{DoxyCode}
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md86}{}\doxysubsubsection{Notes}\label{md_pages_components_rom_fom_apis_autotoc_md86}



\begin{DoxyItemize}
\item For doing Galerkin {\itshape implicit} time stepping.
\item For doing LSPG and WLS. 
\end{DoxyItemize}

See the following examples\+: add

~\newline
 \DoxyHorRuler{0}
 ~\newline
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md87}{}\doxysection{What can you use where?}\label{md_pages_components_rom_fom_apis_autotoc_md87}
As anticipated, not all adapters can be used for all supported ROM methods. The following table illustrates which APIs are admissible for each method.

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{5}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Steady API   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Continuous Time API ~\newline
 (RHS only)   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Continuous Time API ~\newline
 (RHS, Jacobian action)   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Discrete Time API    }\\\cline{1-5}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Steady API   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Continuous Time API ~\newline
 (RHS only)   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Continuous Time API ~\newline
 (RHS, Jacobian action)   }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Discrete Time API    }\\\cline{1-5}
\endhead
Galerkin Explicit Stepping   &NA   &supported   &supported   &NA    \\\cline{1-5}
Galerkin Implicit Stepping   &NA   &NA   &supported   &supported    \\\cline{1-5}
LSPG Unsteady   &NA   &NA   &supported   &supported    \\\cline{1-5}
LSPG Steady   &supported   &NA   &NA   &NA    \\\cline{1-5}
WLS Explicit Stepping   &NA   &supported   &supported   &NA    \\\cline{1-5}
WLS Implicit Stepping   &NA   &NA   &supported   &supported   \\\cline{1-5}
\end{longtabu}


Note\+: for LSPG there is no distinction between explicit and implicit because LSPG only makes sense for implicit time stepping. Actually, it can be shown that explicit LSPG is equivalent to explicit Galerkin.

~\newline
 \DoxyHorRuler{0}
 ~\newline
\hypertarget{md_pages_components_rom_fom_apis_autotoc_md88}{}\doxysection{Frequently Asked Questions}\label{md_pages_components_rom_fom_apis_autotoc_md88}


\begin{DoxyParagraph}{1. Should I prefer the continuous-\/time or discrete-\/time API?}
In general, we suggest users to always prefer the continuous-\/time API because it is more general. However, there are situations where the discrete-\/time API is more useful or even necessary. 
\end{DoxyParagraph}
